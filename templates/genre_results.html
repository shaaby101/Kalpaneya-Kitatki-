{% extends "layout.html" %}
{% block title %}Genre: {{ genre }} - Kannada Library{% endblock %}
{% block content %}
    <header class="main-header">
        <h1>Genre: {{ genre }}</h1>
        <p>Discover works in this genre</p>
    </header>
    
    <div class="work-grid" role="list">
        {% if works and works|length > 0 %}
            {% for work in works %}
                <a href="{{ url_for('work_details', work_id=work.work_id) }}" class="work-card" role="listitem" aria-label="{{ work.title_english }}">
                    <div class="work-poster">
                        {% if work.author_image_url and work.author_image_url.strip() %}
                            <img 
                                src="{{ url_for('static', filename='images/' + work.author_image_url) }}" 
                                alt="Portrait of {{ work.name_english }}"
                                loading="lazy"
                                onerror="this.src='https://placehold.co/500x750/f5f2eb/6b6b6b?text={{ work.name_english|urlencode }}'"
                            >
                        {% elif work.cover_image_url and work.cover_image_url.strip() %}
                            <img 
                                src="{{ url_for('static', filename='images/' + work.cover_image_url) }}" 
                                alt="Cover for {{ work.title_english }}"
                                loading="lazy"
                            >
                        {% else %}
                            <img 
                                src="https://placehold.co/500x750/f5f2eb/6b6b6b?text={{ work.name_english|urlencode }}" 
                                alt="Portrait of {{ work.name_english }}"
                                loading="lazy"
                            >
                        {% endif %}
                    </div>
                    <div class="work-details">
                        <h3 class="work-title">{{ work.title_kannada }}</h3>
                        <p class="work-author">{{ work.name_english }}</p>
                        {% if work.review_count %}
                            <p class="work-stats">
                                <span class="rating">â˜… {{ "%.1f"|format(work.avg_rating) }}</span>
                                <span class="review-count">{{ work.review_count }} review{{ 's' if work.review_count != 1 else '' }}</span>
                            </p>
                        {% endif %}
                    </div>
                </a>
            {% endfor %}
        {% else %}
            <div class="no-results">
                <p>No works found for "{{ genre }}".</p>
                <p>Try searching for a different genre or <a href="{{ url_for('homepage') }}">browse popular works</a>.</p>
            </div>
        {% endif %}
    </div>
{% endblock %}